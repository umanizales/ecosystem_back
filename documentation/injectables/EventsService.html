<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ecosystem_back documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
        <link rel="stylesheet" href="../styles/default.css">
    </head>
    <body>
          <script>
               // Blocking script to avaoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);

               if ($darkModeToggles.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">ecosystem_back documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >EventsService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/events/events.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#buildNotification" >buildNotification</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#cancelEventEmail" >cancelEventEmail</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#changeEventEmail" >changeEventEmail</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#create" >create</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#createEventAndZoom" >createEventAndZoom</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#createEventNormal" >createEventNormal</a>
                            </li>
                            <li>
                                <a href="#findAll" >findAll</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#findByBatch" >findByBatch</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#findByUser" >findByUser</a>
                            </li>
                            <li>
                                <a href="#findOne" >findOne</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getConsumedHours" >getConsumedHours</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getEventsAndActas" >getEventsAndActas</a>
                            </li>
                            <li>
                                <a href="#getExpertHours" >getExpertHours</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getParticipation" >getParticipation</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getRegistersHorus" >getRegistersHorus</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#registersExpert" >registersExpert</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#remove" >remove</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#sendNotificationDB" >sendNotificationDB</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#update" >update</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(eventModel: <a href="../classes/Event.html" target="_self">Model&lt;Event&gt;</a>, entrepreneurService: <a href="../injectables/EntrepreneurService.html" target="_self">EntrepreneurService</a>, expertService: <a href="../injectables/ExpertService.html" target="_self">ExpertService</a>, phasesService: <a href="../injectables/PhasesService.html" target="_self">PhasesService</a>, participationService: <a href="../injectables/ParticipationEventsService.html" target="_self">ParticipationEventsService</a>, integrationsService: <a href="../injectables/IntegrationsService.html" target="_self">IntegrationsService</a>, emailsService: <a href="../injectables/EmailsService.html" target="_self">EmailsService</a>, configService: ConfigService<AppConfiguration>, actaService: <a href="../injectables/ActaService.html" target="_self">ActaService</a>, configNotificationsService: <a href="../injectables/ConfigNotificationsService.html" target="_self">ConfigNotificationsService</a>, usersService: <a href="../injectables/UsersService.html" target="_self">UsersService</a>, notificationsService: <a href="../injectables/NotificationsService.html" target="_self">NotificationsService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/events/events.service.ts:31</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>eventModel</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Event.html" target="_self" >Model&lt;Event&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>entrepreneurService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/EntrepreneurService.html" target="_self" >EntrepreneurService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>expertService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ExpertService.html" target="_self" >ExpertService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>phasesService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/PhasesService.html" target="_self" >PhasesService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>participationService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ParticipationEventsService.html" target="_self" >ParticipationEventsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>integrationsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/IntegrationsService.html" target="_self" >IntegrationsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>emailsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/EmailsService.html" target="_self" >EmailsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>configService</td>
                                                  
                                                        <td>
                                                                    <code>ConfigService&lt;AppConfiguration&gt;</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>actaService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ActaService.html" target="_self" >ActaService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>configNotificationsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ConfigNotificationsService.html" target="_self" >ConfigNotificationsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>usersService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/UsersService.html" target="_self" >UsersService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>notificationsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/NotificationsService.html" target="_self" >NotificationsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="buildNotification"></a>
                    <span class="name">
                        <span ><b>buildNotification</b></span>
                        <a href="#buildNotification"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>buildNotification(type: "creation" | "update" | "delete", accountId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, event: <a href="../classes/Event.html" target="_self">EventEntity</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="705"
                                    class="link-to-prism">src/events/events.service.ts:705</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>instance build notification</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                        <code>&quot;creation&quot; | &quot;update&quot; | &quot;delete&quot;</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>accountId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>event</td>
                                            <td>
                                                            <code><a href="../classes/Event.html" target="_self" >EventEntity</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>{ text: string; date: any; target: string; state: any; type: any; isDeleted: boolean; url: string; }</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="cancelEventEmail"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>cancelEventEmail</b></span>
                        <a href="#cancelEventEmail"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>cancelEventEmail(updatedEvent: <a href="../classes/Event.html" target="_self">EventEntity</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="398"
                                    class="link-to-prism">src/events/events.service.ts:398</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>cancel event, and notify all participant of cancel</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>updatedEvent</td>
                                            <td>
                                                            <code><a href="../classes/Event.html" target="_self" >EventEntity</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="changeEventEmail"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>changeEventEmail</b></span>
                        <a href="#changeEventEmail"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>changeEventEmail(updatedEvent: <a href="../classes/Event.html" target="_self">EventEntity</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="462"
                                    class="link-to-prism">src/events/events.service.ts:462</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>notify all participant of changes in event</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>updatedEvent</td>
                                            <td>
                                                            <code><a href="../classes/Event.html" target="_self" >EventEntity</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="create"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>create</b></span>
                        <a href="#create"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>create(createEventInput: <a href="../classes/CreateEventInput.html" target="_self">CreateEventInput</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="61"
                                    class="link-to-prism">src/events/events.service.ts:61</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>create event</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>createEventInput</td>
                                            <td>
                                                            <code><a href="../classes/CreateEventInput.html" target="_self" >CreateEventInput</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createEventAndZoom"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>createEventAndZoom</b></span>
                        <a href="#createEventAndZoom"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createEventAndZoom(createEventInput: <a href="../classes/CreateEventInput.html" target="_self">CreateEventInput</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="72"
                                    class="link-to-prism">src/events/events.service.ts:72</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>create event with zoom instance, send email and more</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>createEventInput</td>
                                            <td>
                                                            <code><a href="../classes/CreateEventInput.html" target="_self" >CreateEventInput</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createEventNormal"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>createEventNormal</b></span>
                        <a href="#createEventNormal"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createEventNormal(createEventInput: <a href="../classes/CreateEventInput.html" target="_self">CreateEventInput</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="158"
                                    class="link-to-prism">src/events/events.service.ts:158</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>create simple event</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>createEventInput</td>
                                            <td>
                                                            <code><a href="../classes/CreateEventInput.html" target="_self" >CreateEventInput</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findAll"></a>
                    <span class="name">
                        <span ><b>findAll</b></span>
                        <a href="#findAll"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>findAll()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="235"
                                    class="link-to-prism">src/events/events.service.ts:235</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>fin all events</p>
</div>

                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findByBatch"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>findByBatch</b></span>
                        <a href="#findByBatch"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findByBatch(batch: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, user: <a href="../classes/User.html" target="_self">AuthUser</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="275"
                                    class="link-to-prism">src/events/events.service.ts:275</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>find events by batch</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>batch</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>user</td>
                                            <td>
                                                            <code><a href="../classes/User.html" target="_self" >AuthUser</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findByUser"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>findByUser</b></span>
                        <a href="#findByUser"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findByUser(user: <a href="../classes/User.html" target="_self">AuthUser</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="242"
                                    class="link-to-prism">src/events/events.service.ts:242</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>find events for user</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>user</td>
                                            <td>
                                                            <code><a href="../classes/User.html" target="_self" >AuthUser</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findOne"></a>
                    <span class="name">
                        <span ><b>findOne</b></span>
                        <a href="#findOne"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>findOne(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="303"
                                    class="link-to-prism">src/events/events.service.ts:303</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>find event by id</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getConsumedHours"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getConsumedHours</b></span>
                        <a href="#getConsumedHours"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getConsumedHours(startup: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, batch: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="603"
                                    class="link-to-prism">src/events/events.service.ts:603</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>hours consumed by startup in batch</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>startup</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>batch</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getEventsAndActas"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getEventsAndActas</b></span>
                        <a href="#getEventsAndActas"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getEventsAndActas(phase: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="641"
                                    class="link-to-prism">src/events/events.service.ts:641</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>get list of event and actas</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>phase</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getExpertHours"></a>
                    <span class="name">
                        <span ><b>getExpertHours</b></span>
                        <a href="#getExpertHours"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getExpertHours(actas: <a href="../classes/Acta.html" target="_self">Acta[]</a>, expertId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="658"
                                    class="link-to-prism">src/events/events.service.ts:658</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>order data of hours done by expert, only set</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>actas</td>
                                            <td>
                                                            <code><a href="../classes/Acta.html" target="_self" >Acta[]</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>expertId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/Hours.html" target="_self" >{ countHoursDone: number; countHoursDonated: number; }</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getParticipation"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getParticipation</b></span>
                        <a href="#getParticipation"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getParticipation(event: <a href="../classes/Event.html" target="_self">EventEntity</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="517"
                                    class="link-to-prism">src/events/events.service.ts:517</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>get participant list of a event</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>event</td>
                                            <td>
                                                            <code><a href="../classes/Event.html" target="_self" >EventEntity</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getRegistersHorus"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>getRegistersHorus</b></span>
                        <a href="#getRegistersHorus"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getRegistersHorus(expertId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="579"
                                    class="link-to-prism">src/events/events.service.ts:579</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>data of expert hours done</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>expertId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="registersExpert"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>registersExpert</b></span>
                        <a href="#registersExpert"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>registersExpert(user: <a href="../classes/User.html" target="_self">AuthUser</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="524"
                                    class="link-to-prism">src/events/events.service.ts:524</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>data for table dashboard of expert hours done</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>user</td>
                                            <td>
                                                            <code><a href="../classes/User.html" target="_self" >AuthUser</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="remove"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>remove</b></span>
                        <a href="#remove"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>remove(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="355"
                                    class="link-to-prism">src/events/events.service.ts:355</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>soft delete event, and notify all participant of delete</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sendNotificationDB"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>sendNotificationDB</b></span>
                        <a href="#sendNotificationDB"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>sendNotificationDB(participantsId: string[], experts: string[], teamCoach: string[], event, type: "creation" | "update" | "delete")</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="672"
                                    class="link-to-prism">src/events/events.service.ts:672</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>send notifications to participants by event</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>participantsId</td>
                                            <td>
                                                        <code>string[]</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>experts</td>
                                            <td>
                                                        <code>string[]</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>teamCoach</td>
                                            <td>
                                                        <code>string[]</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>event</td>
                                            <td>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                        <code>&quot;creation&quot; | &quot;update&quot; | &quot;delete&quot;</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="update"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>update</b></span>
                        <a href="#update"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>update(id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, updateEventInput: <a href="../classes/UpdateEventInput.html" target="_self">UpdateEventInput</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="310"
                                    class="link-to-prism">src/events/events.service.ts:310</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>update event</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>updateEventInput</td>
                                            <td>
                                                            <code><a href="../classes/UpdateEventInput.html" target="_self" >UpdateEventInput</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, Inject, forwardRef } from &#x27;@nestjs/common&#x27;;
import { CreateEventInput } from &#x27;./dto/create-event.input&#x27;;
import { UpdateEventInput } from &#x27;./dto/update-event.input&#x27;;
import { InjectModel } from &#x27;@nestjs/mongoose&#x27;;
import { Model, Types } from &#x27;mongoose&#x27;;
import { Event as EventEntity } from &#x27;./entities/event.entity&#x27;;
import { AuthUser } from &#x27;src/auth/types/auth-user&#x27;;
import { ValidRoles } from &#x27;src/auth/enums/valid-roles.enum&#x27;;
import { Permission, getPermissionList } from &#x27;src/auth/enums/permissions.enum&#x27;;
import { ExpertService } from &#x27;src/expert/expert.service&#x27;;
import { StartupService } from &#x27;src/startup/startup.service&#x27;;
import { EntrepreneurService } from &#x27;src/entrepreneur/entrepreneur.service&#x27;;
import { PhasesService } from &#x27;src/phases/phases.service&#x27;;
import { ParticipationEventsService } from &#x27;./participation-events/participation-events.service&#x27;;
import { IntegrationsService } from &#x27;src/integrations/integrations.service&#x27;;
import { EmailsService } from &#x27;src/emails/emails.service&#x27;;
import { AppConfiguration } from &#x27;config/app.config&#x27;;
import { ConfigService } from &#x27;@nestjs/config&#x27;;
import { ActaService } from &#x27;./acta/acta.service&#x27;;
import { infoWeekDates } from &#x27;src/shared/utilities/dates.utilities&#x27;;
import { Acta } from &#x27;./acta/entities/acta.entity&#x27;;
import { ConfigNotificationsService } from &#x27;src/notifications/config-notifications/config-notifications.service&#x27;;
import { default_notification_types } from &#x27;src/notifications/types-notifications/model/types-notification.default&#x27;;
import { EmailNotificationTypes } from &#x27;src/notifications/types-notifications/model/email-notification-types.enum&#x27;;
import { Notification as NotificationEntity } from &#x27;src/notifications/entities/notification.entity&#x27;;
import { NotificationStates } from &#x27;src/notifications/enum/notification-states.enum&#x27;;
import { NotificationTypes } from &#x27;src/notifications/enum/notification-types.enum&#x27;;
import { UsersService } from &#x27;src/users/users.service&#x27;;
import { NotificationsService } from &#x27;src/notifications/notifications.service&#x27;;
@Injectable()
export class EventsService {
  constructor(
    @InjectModel(EventEntity.name)
    private readonly eventModel: Model&lt;Event&gt;,
    @Inject(forwardRef(() &#x3D;&gt; EntrepreneurService))
    private readonly entrepreneurService: EntrepreneurService,
    @Inject(forwardRef(() &#x3D;&gt; ExpertService))
    private readonly expertService: ExpertService,
    @Inject(forwardRef(() &#x3D;&gt; PhasesService))
    private readonly phasesService: PhasesService,
    @Inject(forwardRef(() &#x3D;&gt; ParticipationEventsService))
    private readonly participationService: ParticipationEventsService,
    @Inject(forwardRef(() &#x3D;&gt; IntegrationsService))
    private readonly integrationsService: IntegrationsService,
    @Inject(forwardRef(() &#x3D;&gt; EmailsService))
    private readonly emailsService: EmailsService,
    private readonly configService: ConfigService&lt;AppConfiguration&gt;,
    @Inject(forwardRef(() &#x3D;&gt; ActaService))
    private readonly actaService: ActaService,
    @Inject(forwardRef(() &#x3D;&gt; ConfigNotificationsService))
    private readonly configNotificationsService: ConfigNotificationsService,
    @Inject(forwardRef(() &#x3D;&gt; UsersService))
    private readonly usersService: UsersService,
    @Inject(forwardRef(() &#x3D;&gt; NotificationsService))
    private readonly notificationsService: NotificationsService,
  ) {}

  /**
   * create event
   */
  async create(createEventInput: CreateEventInput) {
    if (createEventInput.attendanceType &#x3D;&#x3D;&#x3D; &#x27;zoom&#x27;) {
      return this.createEventAndZoom(createEventInput);
    } else {
      return this.createEventNormal(createEventInput);
    }
  }

  /**
   * create event with zoom instance, send email and more
   */
  async createEventAndZoom(createEventInput: CreateEventInput) {
    const hosting &#x3D; [];
    const participants &#x3D; [];
    const participantsId &#x3D; [];
    const to &#x3D; [];

    const notificationType &#x3D; default_notification_types.find(
      (t) &#x3D;&gt; t.type &#x3D;&#x3D; EmailNotificationTypes.invitationToEvent,
    );
    const notificationsConfig &#x3D;
      await this.configNotificationsService.findByType(
        notificationType._id.toString(),
      );

    for (const iterator of createEventInput.experts) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of createEventInput.teamCoaches) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of createEventInput.participants) {
      if (
        notificationsConfig.excluded.some(
          (userEmail) &#x3D;&gt; userEmail &#x3D;&#x3D; iterator.email,
        )
      )
        continue;
      participants.push({ email: iterator.email });
      to.push(iterator.email);
      participantsId.push(iterator._id);
    }
    var startTime &#x3D; new Date(createEventInput.startAt);
    var endTime &#x3D; new Date(createEventInput.endAt);
    var difference &#x3D; endTime.getTime() - startTime.getTime(); // This will give difference in milliseconds
    var resultInMinutes &#x3D; Math.round(difference / 60000);
    const createdMeeting &#x3D; await this.integrationsService.zoomMeeting(
      createEventInput.name
        .normalize(&#x27;NFD&#x27;)
        .replace(
          /([^n\u0300-\u036f]|n(?!\u0303(?![\u0300-\u036f])))[\u0300-\u036f]+/gi,
          &#x27;$1&#x27;,
        )
        .normalize(),
      createEventInput.startAt,
      resultInMinutes,
      hosting,
      participants,
    );
    const eventCreated &#x3D; await this.eventModel.create({
      ...createEventInput,
      extra_options: {
        ...createEventInput.extra_options,
        zoom: createdMeeting,
      },
    });
    const defaultEmail &#x3D; process.env.SEND_GRID_DEFAULT_VERIFIED_EMAIL;
    const splittedName &#x3D; defaultEmail.split(&#x27;@&#x27;);
    await this.emailsService.sendIcs(
      {
        to: to,
        subject: &#x60;Has sido invitado a ${createEventInput.name}&#x60;,
        text: &#x27;Nuevo evento agendado&#x27;,
        html: &#x60;&lt;p&gt;Se ha agendado un proximo evento de zoom en ecosystem, se llama ${createEventInput.name}, puedes ingresar desde la app, o aquí tienes el &lt;a href&#x3D;&quot;${createdMeeting.join_url}&quot;&gt;link&lt;/a&gt; para el dia del evento  &lt;/p&gt;&#x60;,
      },
      eventCreated.toObject(),
      {
        nameOrganizer: hosting[0] ? hosting[0].name : splittedName[0],
        emailOrganizer: hosting[0] ? hosting[0].email : defaultEmail,
        urlRedirect: this.configService.get(&#x27;appUri&#x27;),
      },
    );
    this.sendNotificationDB(
      participantsId,
      createEventInput.experts.map((i) &#x3D;&gt; i._id),
      createEventInput.teamCoaches.map((i) &#x3D;&gt; i._id),
      eventCreated,
      &#x27;creation&#x27;,
    );
    return eventCreated;
  }

  /**
   * create simple event
   */
  async createEventNormal(createEventInput: CreateEventInput) {
    const hosting &#x3D; [];
    const participants &#x3D; [];
    const participantsId &#x3D; [];
    const to &#x3D; [];

    const notificationType &#x3D; default_notification_types.find(
      (t) &#x3D;&gt; t.type &#x3D;&#x3D; EmailNotificationTypes.invitationToEvent,
    );
    const notificationsConfig &#x3D;
      await this.configNotificationsService.findByType(
        notificationType._id.toString(),
      );

    for (const iterator of createEventInput.experts) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of createEventInput.teamCoaches) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of createEventInput.participants) {
      if (
        notificationsConfig.excluded.some(
          (userEmail) &#x3D;&gt; userEmail &#x3D;&#x3D; iterator.email,
        )
      )
        continue;
      participants.push({ email: iterator.email });
      to.push(iterator.email);
      participantsId.push(iterator._id);
    }
    var startTime &#x3D; new Date(createEventInput.startAt);
    var endTime &#x3D; new Date(createEventInput.endAt);
    var difference &#x3D; endTime.getTime() - startTime.getTime(); // This will give difference in milliseconds
    var resultInMinutes &#x3D; Math.round(difference / 60000);

    const eventCreated &#x3D; await this.eventModel.create({
      ...createEventInput,
      extra_options: {
        ...createEventInput.extra_options,
      },
    });
    const defaultEmail &#x3D; process.env.SEND_GRID_DEFAULT_VERIFIED_EMAIL;
    const splittedName &#x3D; defaultEmail.split(&#x27;@&#x27;);
    await this.emailsService.sendIcs(
      {
        to: to,
        subject: &#x60;Has sido invitado a ${createEventInput.name}&#x60;,
        text: &#x27;Nuevo evento agendado&#x27;,
        html: &#x60;&lt;p&gt;Se ha agendado un proximo evento en ecosystem, se llama ${
          createEventInput.name
        }, puedes ingresar desde la  &lt;a href&#x3D;&quot;${this.configService.get(
          &#x27;appUri&#x27;,
        )}&quot;&gt;app en calendario&lt;/a&gt; &lt;/p&gt; para mas detalles&#x60;,
      },
      eventCreated.toObject(),
      {
        nameOrganizer: hosting[0] ? hosting[0].name : splittedName[0],
        emailOrganizer: hosting[0] ? hosting[0].email : defaultEmail,
        urlRedirect: this.configService.get(&#x27;appUri&#x27;),
      },
    );
    this.sendNotificationDB(
      participantsId,
      createEventInput.experts.map((i) &#x3D;&gt; i._id),
      createEventInput.teamCoaches.map((i) &#x3D;&gt; i._id),
      eventCreated,
      &#x27;creation&#x27;,
    );
    return eventCreated;
  }

  /**
   * fin all events
   */
  findAll() {
    return this.eventModel.find({});
  }

  /**
   * find events for user
   */
  async findByUser(user: AuthUser) {
    let filters &#x3D; {};
    switch (user.rolDoc.type) {
      case ValidRoles.user:
        const docEntrepreneur &#x3D; await this.entrepreneurService.findByAccount(
          user.uid,
        );
        if (!docEntrepreneur) return [];
        filters[&#x27;participants._id&#x27;] &#x3D; docEntrepreneur._id.toString();
        break;
      case ValidRoles.expert:
        const docExpert &#x3D; await this.expertService.findByAccount(user.uid);
        if (!docExpert) return [];
        filters[&#x27;experts._id&#x27;] &#x3D; docExpert._id.toString();
        break;
      case ValidRoles.teamCoach:
        filters[&#x27;teamCoach._id&#x27;] &#x3D; user._id.toString();
        break;
      case ValidRoles.host:
        const listBatchesAccess &#x3D;
          await this.phasesService.getAllBatchesAccessHost(user);
        filters[&#x27;phase&#x27;] &#x3D; {
          $in: listBatchesAccess,
        };
      default:
        break;
    }
    return this.eventModel.find({ isDeleted: false, ...filters });
  }

  /**
   * find events by batch
   */
  async findByBatch(batch: string, user: AuthUser) {
    if (
      ValidRoles.teamCoach &#x3D;&#x3D;&#x3D; user.rolDoc.type &amp;&amp;
      !getPermissionList(user).includes(Permission.load_all_events)
    ) {
      return this.eventModel.find({
        batch,
        isDeleted: false,
        &#x27;teamCoaches._id&#x27;: user._id.toString(),
      });
    }
    if (
      ValidRoles.expert &#x3D;&#x3D;&#x3D; user.rolDoc.type &amp;&amp;
      !getPermissionList(user).includes(Permission.load_all_events)
    ) {
      const docExpert &#x3D; await this.expertService.findByAccount(user.uid);
      return this.eventModel.find({
        batch,
        isDeleted: false,
        &#x27;experts._id&#x27;: docExpert._id.toString(),
      });
    }
    return this.eventModel.find({ batch, isDeleted: false });
  }

  /**
   * find event by id
   */
  findOne(id: string) {
    return this.eventModel.findById(id);
  }

  /**
   * update event
   */
  async update(id: string, updateEventInput: UpdateEventInput) {
    delete updateEventInput[&#x27;_id&#x27;];
    const updatedEvent: EventEntity &#x3D; await this.eventModel
      .findOneAndUpdate({ _id: id }, { ...updateEventInput }, { new: true })
      .lean();
    if (updateEventInput.isCanceled) {
      await this.cancelEventEmail(updatedEvent);
    }
    if (
      updateEventInput?.extra_options &amp;&amp;
      updateEventInput.extra_options[&#x27;editedDates&#x27;] &amp;&amp;
      !updateEventInput.isCanceled
    ) {
      await this.changeEventEmail(updatedEvent);
      const notificationType &#x3D; default_notification_types.find(
        (t) &#x3D;&gt; t.type &#x3D;&#x3D; EmailNotificationTypes.invitationToEvent,
      );
      const notificationsConfig &#x3D;
        await this.configNotificationsService.findByType(
          notificationType._id.toString(),
        );
      const participantsId &#x3D; [];
      for (const iterator of updatedEvent.participants) {
        if (
          notificationsConfig.excluded.some(
            (userEmail) &#x3D;&gt; userEmail &#x3D;&#x3D; iterator.email,
          )
        )
          continue;
        participantsId.push(iterator._id);
      }
      this.sendNotificationDB(
        participantsId,
        updatedEvent.experts.map((i) &#x3D;&gt; i._id.toString()),
        updatedEvent.teamCoaches.map((i) &#x3D;&gt; i._id.toString()),
        updatedEvent,
        &#x27;update&#x27;,
      );
    }
    return updatedEvent;
  }

  /**
   * soft delete event, and notify all participant of delete
   */
  async remove(id: string) {
    const updatedType: EventEntity &#x3D; await this.eventModel
      .findOneAndUpdate({ _id: id }, { isDeleted: true }, { new: true })
      .lean();
    if (updatedType.attendanceType &#x3D;&#x3D;&#x3D; &#x27;zoom&#x27; &amp;&amp; !updatedType.isCanceled) {
      await this.integrationsService.deleteMeeting(
        updatedType.extra_options.zoom[&#x27;id&#x27;],
      );
    }
    if (!updatedType.isCanceled) {
      const notificationType &#x3D; default_notification_types.find(
        (t) &#x3D;&gt; t.type &#x3D;&#x3D; EmailNotificationTypes.invitationToEvent,
      );
      const notificationsConfig &#x3D;
        await this.configNotificationsService.findByType(
          notificationType._id.toString(),
        );
      const participantsId &#x3D; [];
      for (const iterator of updatedType.participants) {
        if (
          notificationsConfig.excluded.some(
            (userEmail) &#x3D;&gt; userEmail &#x3D;&#x3D; iterator.email,
          )
        )
          continue;
        participantsId.push(iterator._id);
      }
      this.sendNotificationDB(
        participantsId,
        updatedType.experts.map((i) &#x3D;&gt; i._id.toString()),
        updatedType.teamCoaches.map((i) &#x3D;&gt; i._id.toString()),
        updatedType,
        &#x27;delete&#x27;,
      );
      await this.cancelEventEmail(updatedType);
    }

    return updatedType;
  }

  /**
   * cancel event, and notify all participant of cancel
   */
  async cancelEventEmail(updatedEvent: EventEntity) {
    const hosting &#x3D; [];
    const participants &#x3D; [];
    const participantsId &#x3D; [];
    const to &#x3D; [];

    const notificationType &#x3D; default_notification_types.find(
      (t) &#x3D;&gt; t.type &#x3D;&#x3D; EmailNotificationTypes.eventUpdate,
    );
    const notificationsConfig &#x3D;
      await this.configNotificationsService.findByType(
        notificationType._id.toString(),
      );

    for (const iterator of updatedEvent.experts) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of updatedEvent.teamCoaches) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of updatedEvent.participants) {
      if (
        notificationsConfig.excluded.some(
          (userEmail) &#x3D;&gt; userEmail &#x3D;&#x3D; iterator.email,
        )
      )
        continue;
      participants.push({ email: iterator.email });
      to.push(iterator.email);
      participantsId.push(iterator._id);
    }
    var startTime &#x3D; new Date(updatedEvent.startAt);
    var endTime &#x3D; new Date(updatedEvent.endAt);
    var difference &#x3D; endTime.getTime() - startTime.getTime(); // This will give difference in milliseconds
    var resultInMinutes &#x3D; Math.round(difference / 60000);
    await this.emailsService.sendIcs(
      {
        to: to,
        subject: &#x60;El evento ${updatedEvent.name} ha sido cancelado&#x60;,
        text: &#x27;Evento cancelado&#x27;,
        html: &#x60;&lt;p&gt;Se ha cancelado un proximo evento en ecosystem, se llama ${updatedEvent.name}, eliminarlo de tu agenda si es el caso.&#x60;,
      },
      updatedEvent,
      {
        nameOrganizer: hosting[0].name,
        emailOrganizer: hosting[0].email,
        urlRedirect: this.configService.get(&#x27;appUri&#x27;),
      },
    );
    this.sendNotificationDB(
      participantsId,
      updatedEvent.experts.map((i) &#x3D;&gt; i._id),
      updatedEvent.teamCoaches.map((i) &#x3D;&gt; i._id),
      updatedEvent,
      &#x27;delete&#x27;,
    );
    return updatedEvent;
  }

  /**
   * notify all participant of changes in event
   */
  async changeEventEmail(updatedEvent: EventEntity) {
    const hosting &#x3D; [];
    const participants &#x3D; [];
    const to &#x3D; [];

    const notificationType &#x3D; default_notification_types.find(
      (t) &#x3D;&gt; t.type &#x3D;&#x3D; EmailNotificationTypes.eventUpdate,
    );
    const notificationsConfig &#x3D;
      await this.configNotificationsService.findByType(
        notificationType._id.toString(),
      );

    for (const iterator of updatedEvent.experts) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of updatedEvent.teamCoaches) {
      hosting.push({ email: iterator.email, name: iterator.name });
      to.push(iterator.email);
    }
    for (const iterator of updatedEvent.participants) {
      if (
        notificationsConfig.excluded.some(
          (userEmail) &#x3D;&gt; userEmail &#x3D;&#x3D; iterator.email,
        )
      )
        continue;
      participants.push({ email: iterator.email });
      to.push(iterator.email);
    }
    var startTime &#x3D; new Date(updatedEvent.startAt);
    var endTime &#x3D; new Date(updatedEvent.endAt);
    var difference &#x3D; endTime.getTime() - startTime.getTime(); // This will give difference in milliseconds
    var resultInMinutes &#x3D; Math.round(difference / 60000);
    await this.emailsService.sendIcs(
      {
        to: to,
        subject: &#x60;El evento ${updatedEvent.name} ha sido modificado&#x60;,
        text: &#x27;Evento modificado&#x27;,
        html: &#x60;&lt;p&gt;Se ha modificado las fechas de un proximo evento en ecosystem, se llama ${updatedEvent.name}, re-agendarlo en tu agenda si es el caso.&#x60;,
      },
      updatedEvent,
      {
        nameOrganizer: hosting[0].name,
        emailOrganizer: hosting[0].email,
        urlRedirect: this.configService.get(&#x27;appUri&#x27;),
      },
    );
    return updatedEvent;
  }

  /**
   * get participant list of a event
   */
  async getParticipation(event: EventEntity) {
    return await this.participationService.findByEvent(event._id);
  }

  /**
   * data for table dashboard of expert hours done
   */
  async registersExpert(user: AuthUser) {
    const docExpert &#x3D; await this.expertService.findByAccount(user.uid);
    const idAsString &#x3D; docExpert._id.toString();
    let dates &#x3D; infoWeekDates();
    let labels &#x3D; [
      &#x27;Domingo&#x27;,
      &#x27;Lunes&#x27;,
      &#x27;Martes&#x27;,
      &#x27;Miércoles&#x27;,
      &#x27;Jueves&#x27;,
      &#x27;Viernes&#x27;,
      &#x27;Sábado&#x27;,
    ];
    let countHoursDone &#x3D; 0;
    let countHoursDonated &#x3D; 0;
    let hoursWeeks &#x3D; [];

    for (const date of dates.fechasSemana) {
      const begin &#x3D; new Date(&#x60;${date}T00:00:00.000Z&#x60;);
      const end &#x3D; new Date(&#x60;${date}T23:59:59.999Z&#x60;);
      const events &#x3D; await this.eventModel
        .find({
          &#x27;experts._id&#x27;: idAsString,
          isCanceled: false,
          isDeleted: false,
          endAt: {
            $gte: begin,
            $lt: end,
          },
        })
        .lean();
      const actas &#x3D; await this.actaService
        .findByEventsList(events.map((i) &#x3D;&gt; i._id.toString()))
        .lean();
      let countsHoursInDay &#x3D; 0;
      for (const acta of actas) {
        if (!acta.extra_options?.expertHours[idAsString]) continue;
        countsHoursInDay +&#x3D; acta.extra_options.expertHours[idAsString].done;
        countHoursDone +&#x3D; acta.extra_options.expertHours[idAsString].done;
        countHoursDonated +&#x3D; acta.extra_options.expertHours[idAsString].donated;
      }
      hoursWeeks.push(countsHoursInDay);
    }
    return {
      labels,
      data: hoursWeeks,
      dateLabels: dates,
      countHoursDone,
      countHoursDonated,
    };
  }

  /**
   * data of expert hours done
   */
  async getRegistersHorus(expertId: string) {
    const events &#x3D; await this.eventModel
      .find({
        &#x27;experts._id&#x27;: new Types.ObjectId(expertId),
        isCanceled: false,
        isDeleted: false,
      })
      .lean();
    const actas &#x3D; await this.actaService
      .findByEventsList(events.map((i) &#x3D;&gt; i._id.toString()))
      .lean();
    let countHoursDone &#x3D; 0;
    let countHoursDonated &#x3D; 0;
    for (const acta of actas) {
      if (!acta.extra_options?.expertHours[expertId]) continue;
      countHoursDone +&#x3D; acta.extra_options.expertHours[expertId].done;
      countHoursDonated +&#x3D; acta.extra_options.expertHours[expertId].donated;
    }
    return { countHoursDone, countHoursDonated };
  }

  /**
   * hours consumed by startup in batch
   */
  async getConsumedHours(startup: string, batch: string) {
    const events &#x3D; await this.eventModel
      .find({
        batch: new Types.ObjectId(batch),
        &#x27;participants.startupEntrepreneur&#x27;: startup,
        isCanceled: false,
        isDeleted: false,
      })
      .lean();

    const actas &#x3D; await this.actaService
      .findByEventsList(events.map((i) &#x3D;&gt; i._id.toString()))
      .lean();

    let acc &#x3D; {};
    for (const acta of actas) {
      if (
        !acta.extra_options?.expertHours ||
        Object.keys(acta.extra_options?.expertHours).length &#x3D;&#x3D; 0
      )
        continue;
      const event &#x3D; events.filter(
        (e) &#x3D;&gt; e._id.toString() &#x3D;&#x3D;&#x3D; acta.event.toString(),
      );
      Object.values(acta.extra_options.expertHours).forEach((element: any) &#x3D;&gt; {
        if (!acc[event[0].type]) {
          acc[event[0].type] &#x3D; element.done + element.donated;
        } else {
          acc[event[0].type] +&#x3D; element.done + element.donated;
        }
      });
    }
    return { hours: acc };
  }

  /**
   * get list of event and actas
   */
  async getEventsAndActas(phase: string) {
    const events: EventEntity[] &#x3D; await this.eventModel
      .find({
        batch: new Types.ObjectId(phase),
        isCanceled: false,
        isDeleted: false,
      })
      .lean();
    const actas: Acta[] &#x3D; await this.actaService
      .findByEventsList(events.map((i) &#x3D;&gt; i._id.toString()))
      .lean();
    return { events, actas };
  }

  /**
   * order data of hours done by expert, only set
   */
  getExpertHours(actas: Acta[], expertId: string) {
    let countHoursDone &#x3D; 0;
    let countHoursDonated &#x3D; 0;
    for (const acta of actas) {
      if (!acta.extra_options?.expertHours[expertId]) continue;
      countHoursDone +&#x3D; acta.extra_options.expertHours[expertId].done;
      countHoursDonated +&#x3D; acta.extra_options.expertHours[expertId].donated;
    }
    return { countHoursDone, countHoursDonated };
  }

  /**
   * send notifications to participants by event
   */
  async sendNotificationDB(
    participantsId: string[],
    experts: string[],
    teamCoach: string[],
    event,
    type: &#x27;creation&#x27; | &#x27;update&#x27; | &#x27;delete&#x27;,
  ) {
    const entrepreneursDocs &#x3D;
      await this.entrepreneurService.findMany(participantsId);
    const expertsDoc &#x3D; await this.expertService.findMany(experts);
    const users &#x3D; await this.usersService.findManyByUUID([
      ...entrepreneursDocs.filter((i) &#x3D;&gt; i.accountId).map((i) &#x3D;&gt; i.accountId),
      ...expertsDoc.filter((i) &#x3D;&gt; i.accountId).map((i) &#x3D;&gt; i.accountId),
    ]);
    const notificationList &#x3D; [];
    for (const iterator of users) {
      const notification &#x3D; this.buildNotification(
        type,
        iterator._id.toString(),
        event,
      );
      notificationList.push(notification);
    }
    for (const iterator of teamCoach) {
      const notification &#x3D; this.buildNotification(type, iterator, event);
      notificationList.push(notification);
    }
    return this.notificationsService.createMany(notificationList);
  }

  /**
   * instance build notification
   */
  buildNotification(
    type: &#x27;creation&#x27; | &#x27;update&#x27; | &#x27;delete&#x27;,
    accountId: string,
    event: EventEntity,
  ) {
    let text &#x3D; &#x60;Estas en el evento ${event.name}&#x60;;
    switch (type) {
      case &#x27;creation&#x27;:
        text &#x3D; &#x60;Tienes un nuevo evento llamado ${event.name}, míralo ahora en tu agenda&#x60;;
        break;
      case &#x27;update&#x27;:
        text &#x3D; &#x60;El evento ${event.name} ha sido modificado&#x60;;
        break;
      case &#x27;delete&#x27;:
        text &#x3D; &#x60;El evento ${event.name} ha sido cancelado&#x60;;
        break;
      default:
        break;
    }
    const urlInvitation &#x3D; process.env.APP_URI + &#x27;/home/calendar&#x27;;
    return {
      text,
      date: new Date(),
      target: &#x60;userNotification ${accountId};&#x60;,
      state: NotificationStates.pending,
      type: NotificationTypes.calendar,
      isDeleted: false,
      url: urlInvitation,
    };
  }
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'EventsService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
